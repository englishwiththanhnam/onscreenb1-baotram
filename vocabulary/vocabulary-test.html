<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Học Từ Vựng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBUet6ZsBTwJG_gTKM2bGFG1AKD3t0hV20",
            authDomain: "b1-baotram.firebaseapp.com",
            projectId: "b1-baotram",
            storageBucket: "b1-baotram.appspot.com",
            messagingSenderId: "948701163187",
            appId: "1:948701163187:web:043f2d381d63e741114ac6",
            measurementId: "G-33NHT07JHE"
        };
        window.firebaseConfig = firebaseConfig;
    </script>
    <style>
        :root { --blur-intensity: 12px; --saturation-intensity: 150%; --glass-bg-color: rgba(255, 255, 255, 0.45); --glass-border-color: rgba(255, 255, 255, 0.6); --shadow-color: rgba(67, 56, 202, 0.15); --primary-accent: #6d28d9; --text-primary: #0f172a; --text-secondary: #475569; --app-bg-start: #f5f7ff; --app-bg-end: #e0e7ff; }
        body.dark { --glass-bg-color: rgba(29, 39, 58, 0.45); --glass-border-color: rgba(255, 255, 255, 0.2); --shadow-color: rgba(0, 0, 0, 0.25); --primary-accent: #a78bfa; --text-primary: #f1f5f9; --text-secondary: #94a3b8; --app-bg-start: #0f172a; --app-bg-end: #1e293b; }
        body { font-family: 'Be Vietnam Pro', sans-serif; background-color: var(--app-bg-start); background-image: linear-gradient(135deg, var(--app-bg-start) 0%, var(--app-bg-end) 100%); color: var(--text-primary); overflow-x: hidden; position: relative; }
        body.sidebar-open { overflow: hidden; }
        .background-shapes { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
        .shape { position: absolute; border-radius: 50%; box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1); filter: blur(15px); transition: opacity 0.5s ease; }
        .shape1 { width: 250px; height: 250px; background: linear-gradient(135deg, #8b5cf6, #3b82f6); top: 10%; left: 5%; animation: float 28s infinite alternate ease-in-out; }
        .shape2 { width: 180px; height: 180px; background: linear-gradient(135deg, #14b8a6, #67e8f9); bottom: 15%; right: 10%; animation: float 32s infinite alternate ease-in-out; }
        .shape3 { width: 120px; height: 120px; background: linear-gradient(135deg, #a78bfa, #c4b5fd); top: 20%; right: 25%; animation: float 24s infinite alternate ease-in-out; }
        .shape4 { width: 80px; height: 80px; background: linear-gradient(135deg, #93c5fd, #bfdbfe); bottom: 5%; left: 30%; animation: float 20s infinite alternate ease-in-out; }
        body.dark .shape { opacity: 0.4; }
        @keyframes float { from { transform: translateY(20px) scale(1) rotate(0deg); } to { transform: translateY(-20px) scale(1.05) rotate(20deg); } }
        .app-layout { display: flex; height: 100vh; width: 100vw; position: relative; z-index: 1; transition: padding-left 0.3s ease-in-out; }
        .glass-panel { position: relative; background: var(--glass-bg-color); backdrop-filter: blur(var(--blur-intensity)) saturate(var(--saturation-intensity)); -webkit-backdrop-filter: blur(var(--blur-intensity)) saturate(var(--saturation-intensity)); border-radius: 24px; border: 1px solid var(--glass-border-color); box-shadow: 0 8px 32px 0 var(--shadow-color), inset 0 2px 4px rgba(255, 255, 255, 0.2); transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); overflow: hidden; }
        .card { padding: 1.5rem; }
        #sidebar { position: fixed; top: 0; left: 0; height: 100%; width: 260px; padding: 1.5rem; z-index: 40; transform: translateX(-100%); transition: transform 0.3s ease-in-out; display: flex; flex-direction: column; }
        body.sidebar-open #sidebar { transform: translateX(0); }
        @media (min-width: 1024px) { #sidebar { position: relative; transform: translateX(0); flex-shrink: 0; } .app-layout.sidebar-collapsed #sidebar { transform: translateX(-100%); margin-left: -260px; } }
        #sidebar-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 30; opacity: 0; visibility: hidden; transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out; }
        body.sidebar-open #sidebar-overlay { opacity: 1; visibility: visible; }
        @media (min-width: 1024px) { #sidebar-overlay { display: none; } }
        .sidebar-nav-btn { display: flex; align-items: center; padding: 12px 16px; border-radius: 12px; font-weight: 600; color: var(--text-secondary); transition: all 0.2s ease-in-out; margin-bottom: 8px; }
        .sidebar-nav-btn i { width: 20px; margin-right: 16px; text-align: center; }
        .sidebar-nav-btn:hover { background-color: rgba(255, 255, 255, 0.4); color: var(--text-primary); transform: translateX(5px) scale(1.03); box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .sidebar-nav-btn.active { background-color: var(--primary-accent); color: white; box-shadow: 0 4px 12px rgba(91, 33, 182, 0.3); transform: translateX(5px) scale(1.03); }
        body.dark .sidebar-nav-btn.active { color: #1e293b; box-shadow: 0 4px 12px rgba(167, 139, 250, 0.3); }
        body.dark .sidebar-nav-btn:hover { background-color: rgba(255, 255, 255, 0.1); }
        #app { flex-grow: 1; height: 100vh; overflow-y: auto; padding: 1.5rem; transition: margin-left 0.3s ease-in-out; }
        @media (min-width: 1024px) { #app { padding: 2rem; } }
        .main-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem; }
        #menu-toggle-btn { background: rgba(255, 255, 255, 0.4); backdrop-filter: blur(4px); border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; color: var(--text-primary); flex-shrink: 0; }
        .btn { padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; justify-content: center; gap: 8px; border: 1px solid transparent; transform: translateY(0); }
        .btn-main-action { background: var(--primary-accent); color: white; border-color: rgba(255, 255, 255, 0.2); box-shadow: 0 4px 15px rgba(91, 33, 182, 0.25); }
        body.dark .btn-main-action { color: #1e293b; }
        .btn-main-action:hover { background: #5b21b6; transform: translateY(-3px); box-shadow: 0 7px 20px rgba(91, 33, 182, 0.4); }
        body.dark .btn-main-action:hover { background: #9333ea; }
        .btn-secondary { background: rgba(255, 255, 255, 0.4); color: var(--text-primary); border-color: rgba(255, 255, 255, 0.6); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.7); transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        body.dark .btn-secondary { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.2); }
        body.dark .btn-secondary:hover { background: rgba(255, 255, 255, 0.2); }
        .btn:disabled { background-color: rgba(200, 200, 200, 0.7) !important; cursor: not-allowed; opacity: 0.7; transform: none !important; box-shadow: none !important; }
        body.dark .btn:disabled { background-color: rgba(71, 85, 105, 0.7) !important; }
        .answer-option { background: rgba(255, 255, 255, 0.3); border: 1px solid rgba(255, 255, 255, 0.4); padding: 12px; border-radius: 12px; cursor: pointer; transition: all 0.2s ease-in-out; text-align: center; color: var(--text-primary); box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .answer-option.correct { background-color: #dcfce7 !important; border-color: #22c55e !important; color: #15803d !important; cursor: not-allowed; }
        body.dark .answer-option.correct { background-color: #052e16 !important; border-color: #16a34a !important; color: #a7f3d0 !important; }
        .answer-option.incorrect { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #b91c1c !important; animation: shake 0.5s; }
        body.dark .answer-option.incorrect { background-color: #450a0a !important; border-color: #dc2626 !important; color: #fecaca !important; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.2); backdrop-filter: blur(8px); align-items: center; justify-content: center; }
        .modal.is-open { display: flex; }
        .modal-content { animation: scaleIn 0.3s cubic-bezier(0.165, 0.84, 0.44, 1) forwards; }
        @keyframes scaleIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>
    <div id="loader-overlay" class="fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-[200]">
        <div class="w-16 h-16 border-8 border-t-violet-500 border-gray-200 rounded-full animate-spin"></div>
    </div>
    
    <div id="app-container" class="hidden">
        <!-- The full vocabulary app UI from template.html will be injected here by script -->
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

        const db = getFirestore(initializeApp(window.firebaseConfig));
        let submissionId = null;
        
        const VocabApp = {
            // ... Full JS from template.html, modified for Firestore ...
        };

        async function main() {
            const params = new URLSearchParams(window.location.search);
            submissionId = params.get('submission_id');
            if (submissionId) {
                // VocabApp.init(submissionId); // This will be the entry point
            } else {
                document.getElementById('loader-overlay').innerHTML = `<p class="text-white text-xl font-bold">Lỗi: Không tìm thấy mã truy cập.</p>`;
            }
        }
        
        // main(); // Will be implemented fully
    </script>
</body>
</html>
